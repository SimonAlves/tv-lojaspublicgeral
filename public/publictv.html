<!DOCTYPE html>
<html>
<head><title>TV Polipet</title></head>
<body style="margin:0; background:black; overflow:hidden; font-family:Arial;">
    <div style="display:flex; height:100vh;">
        <div style="flex:3; background:black; display:flex; align-items:center;">
            <video src="promo.mp4" autoplay loop muted playsinline style="width:100%; height:100%; object-fit:contain;"></video>
        </div>
        <div style="flex:1; background:#ce0000; display:flex; flex-direction:column; align-items:center; justify-content:center; border-left:5px solid white; text-align:center; color:white;">
            <img src="logo.png" style="width:150px; background:white; padding:10px; border-radius:10px; margin-bottom:20px;">
            <h1 id="nomeProd" style="font-size:2rem; padding:0 10px;">CARREGANDO...</h1>
            <img id="qr" style="border:5px solid white; width:80%; max-width:250px;">
            <p style="margin-top:5px; font-weight:bold;">ESCANEIE AGORA</p>
            <h2>RESTAM: <span id="num" style="font-size:4rem; color:#fff700">--</span></h2>
        </div>
    </div>
    
    <div id="fim" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:black; color:white; align-items:center; justify-content:center; flex-direction:column; z-index:99;">
        <img src="logo.png" width="200" style="margin-bottom:20px;">
        <h1 style="font-size:3rem;">OFERTA ENCERRADA</h1>
        <p style="font-size:1.5rem;">Fique ligado na próxima promoção!</p>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        document.getElementById('qr').src = '/qrcode';
        
        socket.on('status', (d) => {
            document.getElementById('nomeProd').innerHTML = d.produto;
            document.getElementById('num').innerText = d.restante;
            
            const fimDiv = document.getElementById('fim');
            if(!d.ativa || d.restante <= 0) {
                fimDiv.style.display = 'flex';
            } else {
                fimDiv.style.display = 'none';
            }
        });
    </script>
</body>
</html>